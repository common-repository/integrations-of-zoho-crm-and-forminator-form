"use strict";(self.webpackChunk_frm_in=self.webpackChunk_frm_in||[]).push([[467],{5467:(e,t,a)=>{a.r(t),a.d(t,{addFieldMap:()=>h,checkWebhookIntegrationsExist:()=>p,delFieldMap:()=>w,handleAuthorize:()=>m,handleCustomValue:()=>y,handleFieldMapping:()=>I,saveActionConf:()=>_,saveIntegConfig:()=>f,setGrantTokenResponse:()=>g});var n=a(6325),l=a(5904),i=a(4501),r=a.n(i),o=a(6766),s=a(8450),d=a(8496),u=a(7830),c=["Webhook","KaliForms","Amelia","WPFunnels","Typebot","JetForm","FluentSupport"],p=function(e){return c.includes(e)},f=function(){var e=(0,l.A)(r().mark((function e(t,a,n,l,i,o,s,c){var f,_,g,m,v,h,w,I,y,A,F,b;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g="flow/save",c(!0),m=l,"cond"!==(null==l||null==(f=l.condition)?void 0:f.action_behavior)&&(m.condition={action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]}),"Elementor"===t.triggered_entity&&(m.postId=s?null!=(v=null==t||null==(h=t.flow_details)?void 0:h.postId)?v:null:null!=(w=null==t||null==(I=t.triggerData)?void 0:I.postId)?w:null),y={name:l.name,trigger:t.triggered_entity,triggered_entity_id:null!=t&&null!=(_=t.triggerData)&&_.formID?t.triggerData.formID:t.triggered_entity_id||0,flow_details:m},t.id&&(y.id=t.id),p(t.triggered_entity)&&(y.flow_details.fields=s?null==t||null==(F=t.flow_details)?void 0:F.fields:null==t||null==(A=t.triggerDetail)?void 0:A.data),s&&(g="flow/update"),e.prev=9,e.next=12,(0,d.A)(y,g);case 12:return b=e.sent,!s&&b.success&&i.push(n),c(!1),e.abrupt("return",b);case 18:return e.prev=18,e.t0=e.catch(9),c(!1),e.abrupt("return",(0,u.__)("Failed to save integration"));case 22:case"end":return e.stop()}}),e,null,[[9,18]])})));return function(t,a,n,l,i,r,o,s){return e.apply(this,arguments)}}(),_=function(){var e=(0,l.A)(r().mark((function e(t){var a,n,l,i,s,c,f,_,g,m,v,h,w,I,y,A;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.flow,t.setFlow,l=t.allIntegURL,i=t.conf,s=t.history,t.index,c=t.edit,f=t.setIsLoading,t.setSnackbar,_="flow/save",f&&f instanceof Function&&f(!0),g=i,"Elementor"===n.triggered_entity&&(g.postId=c?null!=(m=null==n||null==(v=n.flow_details)?void 0:v.postId)?m:null:null!=(h=null==n||null==(w=n.triggerData)?void 0:w.postId)?h:null),I={name:i.name,trigger:n.triggered_entity,triggered_entity_id:null!=n&&null!=(a=n.triggerData)&&a.formID?n.triggerData.formID:n.triggered_entity_id||0,flow_details:g},n.id&&(I.id=n.id),p(n.triggered_entity)&&(I.flow_details.fields=c?null==n||null==(A=n.flow_details)?void 0:A.fields:null==n||null==(y=n.triggerDetail)?void 0:y.data),c&&(_="flow/update"),e.prev=9,e.next=12,(0,d.A)(I,_).then((function(e){var t;!c&&e.success&&s.push(l);var a="",n="success";null!=(t=e.data)&&t.msg?a=e.data.msg:e.success?a=c?(0,u.__)("Integration updated successfully"):(0,u.__)("Integration saved successfully"):(n="error",a=c?(0,u.__)("Failed to update integration"):(0,u.__)("Failed to save integration")),(0,o.Ay)(a,{type:n}),f&&f instanceof Function&&f(!1),c||setTimeout((function(){s.push(l)}),700)}));case 12:e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(9),f&&f instanceof Function&&f(!1),e.abrupt("return",(0,u.__)("Failed to save integration"));case 18:case"end":return e.stop()}}),e,null,[[9,14]])})));return function(t){return e.apply(this,arguments)}}(),g=function(e){var t={},a=window.location.href.replace(window.opener.location.href+"/redirect","").split("&");a&&a.forEach((function(e){var a=e.split("=");a[1]&&(t[a[0]]=a[1])})),localStorage.setItem("__"+e,JSON.stringify(t)),window.close()},m=function(e,t,a,l,i,r,o,d,c){if(l.dataCenter&&l.clientId&&l.clientSecret){d(!0);var p="https://accounts.zoho."+l.dataCenter+"/oauth/v2/auth?scope="+a+"&response_type=code&client_id="+l.clientId+"&prompt=Consent&access_type=offline&redirect_uri="+encodeURIComponent(null==s.FH?void 0:s.FH.base)+"/redirect&state="+encodeURIComponent(window.location.href)+"/redirect",f=window.open(p,e,"width=400,height=609,toolbar=off"),_=setInterval((function(){if(f.closed){clearInterval(_);var a={},r=!1,s=localStorage.getItem("__"+e);if(s&&(r=!0,a=JSON.parse(s),localStorage.removeItem("__"+e)),a.code&&!a.error&&a&&r){var p=(0,n.A)({},l);p.accountServer=a["accounts-server"],v(t,a,p,i,o,d,c)}else{var g=a.error?"Cause: "+a.error:"";c({show:!0,msg:(0,u.__)("Authorization failed")+" "+g+". "+(0,u.__)("please try again")}),d(!1)}}}),500)}else r({dataCenter:l.dataCenter?"":(0,u.__)("Data center cann't be empty"),clientId:l.clientId?"":(0,u.__)("Client ID cann't be empty"),clientSecret:l.clientSecret?"":(0,u.__)("Secret key cann't be empty")})},v=function(e,t,a,l,i,r,o){var c=(0,n.A)({},t);c.dataCenter=a.dataCenter,c.clientId=a.clientId,c.clientSecret=a.clientSecret,c.redirectURI=(null==s.FH?void 0:s.FH.base)+"/redirect",(0,d.A)(c,e+"_generate_token").then((function(e){return e})).then((function(e){if(e&&e.success){var t=(0,n.A)({},a);t.tokenDetails=e.data,l(t),i(!0),o({show:!0,msg:(0,u.__)("Authorized Successfully")})}else e&&e.data&&e.data.data||!e.success&&"string"===typeof e.data?o({show:!0,msg:""+(0,u.__)("Authorization failed Cause:")+(e.data.data||e.data)+". "+(0,u.__)("please try again")}):o({show:!0,msg:(0,u.__)("Authorization failed. please try again")});r(!1)}))},h=function(e,t,a,l,i){var r=(0,n.A)({},t);i?l?r.relatedlists[i-1].upload_field_map.splice(e,0,{}):r.relatedlists[i-1].field_map.splice(e,0,{}):l?r.upload_field_map.splice(e,0,{}):r.field_map.splice(e,0,{}),a((0,n.A)({},r))},w=function(e,t,a,l,i){var r=(0,n.A)({},t);i?l?r.relatedlists[i-1].upload_field_map.length>1&&r.relatedlists[i-1].upload_field_map.splice(e,1):r.relatedlists[i-1].field_map.length>1&&r.relatedlists[i-1].field_map.splice(e,1):l?r.upload_field_map.length>1&&r.upload_field_map.splice(e,1):r.field_map.length>1&&r.field_map.splice(e,1),a((0,n.A)({},r))},I=function(e,t,a,l,i,r){var o=(0,n.A)({},a);r?i?o.relatedlists[r-1].upload_field_map[t][e.target.name]=e.target.value:o.relatedlists[r-1].field_map[t][e.target.name]=e.target.value:i?o.upload_field_map[t][e.target.name]=e.target.value:o.field_map[t][e.target.name]=e.target.value,"custom"===e.target.value&&(r?o.relatedlists[r-1].field_map[t].customValue="":o.field_map[t].customValue=""),l((0,n.A)({},o))},y=function(e,t,a,l,i){var r=(0,n.A)({},a);i?r.relatedlists[i-1].field_map[t].customValue=e.target.value:r.field_map[t].customValue=e.target.value,l((0,n.A)({},r))}}}]);